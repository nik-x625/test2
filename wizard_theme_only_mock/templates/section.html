<div class="section-edit-container">
    <h2>{{ section.title }}</h2>
    
    <div class="section-content">
        {{ section.content|safe }}
    </div>
    
    <div class="placeholder-fields">
        <h3>Fill in the details</h3>
        
        {% set placeholders = [] %}
        {% for placeholder in section.content|regex_findall('<span class="placeholder" data-field="([^"]+)">([^<]+)</span>') %}
            {% if placeholder[0] not in placeholders %}
                {% set _ = placeholders.append(placeholder[0]) %}
                <div class="form-group">
                    <label for="{{ placeholder[0] }}">{{ placeholder[0]|replace('_', ' ')|title }}</label>
                    <input type="text" id="{{ placeholder[0] }}" name="{{ placeholder[0] }}" 
                           placeholder="{{ placeholder[1] }}"
                           hx-trigger="keyup changed delay:500ms"
                           hx-target=".section-content"
                           hx-swap="innerHTML">
                </div>
            {% endif %}
        {% endfor %}
    </div>
</div>

<script>
    // Update placeholders in real-time as user types
    document.querySelectorAll('.placeholder-fields input').forEach(input => {
        input.addEventListener('input', function() {
            const field = this.id;
            const value = this.value || this.placeholder;
            
            document.querySelectorAll(`.placeholder[data-field="${field}"]`).forEach(placeholder => {
                if (value && value.trim() !== '') {
                    placeholder.classList.add('filled');
                    placeholder.textContent = value;
                } else {
                    placeholder.classList.remove('filled');
                    placeholder.textContent = placeholder.getAttribute('data-field').replace('_', ' ').replace(/\b\w/g, l => l.toUpperCase());
                }
            });
        });
    });
</script>
